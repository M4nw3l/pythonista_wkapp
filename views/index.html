<%!

class IndexPlaceHolderView:
	def on_init(self):
		self.name = ''
		
	def test_action(self, text,*args):
		print(text,args)
		self.element('header').set('text',f'hello javascript! text was {text} args were {args}')

view_class = IndexPlaceHolderView

%>

<%inherit file="view.html"/>
<div class="pt-2">
<a href="/first_view.html">First view</a>
<a href="/test_view.html">Test View</a>
<button onclick="app.exit()">Exit Application</button>

<h3 class="pt-1">WKApp index.html placeholder</h3>

<p>
To replace this placeholder simply create a file `views/index.html`, then add your html and setup a `view_class` mixin. An instance is created and maintained automatically for holding state, listening on view lifecycle events and two way interop between python and client-side javascript, providing element/DOM manipulation and wide flexibility to customise view/page behaviour. 

A simple view example:

<div style="width:90%" class="p-4 m-2 border">
<button onclick="view.invoke('test_action', 'hello python!', 'pass','any','args',{},1,1.5)">Call Python</button>
<button onclick="app.exit()">Exit Application</button>
<div>
  <h1 id="header">Hello World!</h1>
  <form method="POST">
    <label>Enter your name:</label>
    <input name="name" type="text" value="${view.name}" />
    <br />
    <input type="submit" value="Submit" />
  </form>
% if view.name != '': 
    <h2> Hello ${view.name}! </h2>
% endif
</div>
</div>

${codeblock("""

<%!

class MyFirstView:
	def on_init(self):
		self.name = ''
		
	def test_action(self, text,*args):
		print(text,args)
		self.element('header').set('text',f'hello javascript! text was {text} args were {args}')
		

view_class = MyFirstView

%>

<!-- inherit from the view.html template to render the views content inside the apps customisable base layout and structure -->
<%inherit file="view.html"/>
<!-- Your page content goes here -->
<button onclick="view.invoke('test_action', 'hello python!', 'pass','any','args',{},1,1.5)">Call Python</button>
<button onclick="app.exit()">Exit Application</button>
<div>
  <h1 id="header">Hello World!</h1>
  <form method="POST">
    <label>Enter your name:</label>
    <input name="name" type="text" value="${view.name}" />
    <br />
    <input type="submit" value="Submit" />
  </form>
% if view.name != '': 
    <h2> Hello ${view.name}! </h2>
% endif
</div>
""")}
</p>
<style>
textarea.code {
	display: block;
	width: 95%;
	font-family: monospace;
	border: 1px solid #bbb;
	white-space:pre-wrap;
	text-align:left;
	field-sizing: content;
}
</style>

<%def name="codeblock(text, rows=0)">
	<%
		if rows == 0:
		  rows = text.count("\n")+1
	%>
	<textarea class="code" contenteditable="true" spellcheck="false" aria-label='Code Sample' rows="${rows}" readonly>
	${text}
	</textarea>
</%def>
